<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hospital Management System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { font-family: 'Segoe UI', sans-serif; background-color: #f8f9fa; }
    .navbar { background-color: #00796B; }
    .navbar-brand, .nav-link, .btn-primary { color: white !important; }
    .table th, .table td { vertical-align: middle; }
    .status-occupied { color: #2196F3; font-weight: bold; }
    .status-available { color: #4CAF50; font-weight: bold; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark px-3">
    <a class="navbar-brand" href="#">Hospital Management System</a>
    <button class="btn btn-light ms-auto" onclick="logout()">Logout</button>
  </nav>

  <div class="container mt-4">
    <ul class="nav nav-tabs" id="tabs">
      <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#patients">Patients</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#doctors">Doctors</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#departments">Departments</a></li>
    </ul>
    <div class="tab-content mt-3">
      <div class="tab-pane fade show active" id="patients">
        <button class="btn btn-primary mb-2" onclick="addPatient()">+ Add Patient</button>
        <table class="table table-bordered" id="patientTable">
          <thead><tr><th>Bed</th><th>Status</th><th>Name</th><th>Diagnosis</th><th>Height</th><th>Weight</th><th>Temp (°C)</th><th>BP</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="tab-pane fade" id="doctors">
        <button class="btn btn-primary mb-2" onclick="addDoctor()">+ Add Doctor</button>
        <table class="table table-bordered" id="doctorTable">
          <thead><tr><th>Name</th><th>Department</th><th>Experience</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="tab-pane fade" id="departments">
        <button class="btn btn-primary mb-2" onclick="addDepartment()">+ Add Department</button>
        <table class="table table-bordered" id="departmentTable">
          <thead><tr><th>Department</th><th>Head</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content p-4">
        <h5 class="modal-title">Login</h5>
        <input id="email" class="form-control mb-2" placeholder="Email" type="email" />
        <input id="password" class="form-control mb-3" placeholder="Password" type="password" />
        <button class="btn btn-primary w-100" onclick="login()">Login</button>
        <button class="btn btn-link w-100 mt-2" onclick="signup()">New user? Sign up</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // 🔁 Replace with your Firebase config:
    const firebaseConfig = {
        apiKey: "AIzaSyBd4Mz9Yayx5PrZWoAszcu95TxMMRB9bOU",
  authDomain: "hospital-management-d803f.firebaseapp.com",
  projectId: "hospital-management-d803f",
  storageBucket: "hospital-management-d803f.firebasestorage.app",
  messagingSenderId: "404354361635",
  appId: "1:404354361635:web:cbbdba7cfa51b65c0cc496"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // 🔐 Login/Signup/Logout
    auth.onAuthStateChanged(user => {
      if (!user) {
        new bootstrap.Modal(document.getElementById('loginModal')).show();
      } else {
        loadAllData();
      }
    });

    function login() {
      auth.signInWithEmailAndPassword(email.value, password.value)
        .catch(e => alert(e.message));
    }

    function signup() {
      auth.createUserWithEmailAndPassword(email.value, password.value)
        .catch(e => alert(e.message));
    }

    function logout() {
      auth.signOut();
    }

    // ➕ Add & Load Patients
    function addPatient() {
      const patient = {
        bed: "Room 1 - Bed " + (Date.now() % 1000),
        status: "occupied",
        name: "Amit Sharma",
        diagnosis: "Flu",
        height: "1.70",
        weight: "65",
        temp: "38.5",
        bp: "120/80"
      };
      db.collection("patients").add(patient).then(loadPatients);
    }

    function loadPatients() {
      db.collection("patients").get().then(snapshot => {
        const tbody = document.querySelector("#patientTable tbody");
        tbody.innerHTML = "";
        snapshot.forEach(doc => {
          const p = doc.data();
          tbody.innerHTML += `<tr>
            <td>${p.bed}</td><td class="status-occupied">${p.status}</td><td>${p.name}</td>
            <td>${p.diagnosis}</td><td>${p.height}</td><td>${p.weight}</td>
            <td>${p.temp}</td><td>${p.bp}</td>
          </tr>`;
        });
      });
    }

    function addDoctor() {
      const doctor = { name: "Dr. Priya Rathi", department: "Cardiology", experience: "10 years" };
      db.collection("doctors").add(doctor).then(loadDoctors);
    }

    function loadDoctors() {
      db.collection("doctors").get().then(snapshot => {
        const tbody = document.querySelector("#doctorTable tbody");
        tbody.innerHTML = "";
        snapshot.forEach(doc => {
          const d = doc.data();
          tbody.innerHTML += `<tr><td>${d.name}</td><td>${d.department}</td><td>${d.experience}</td></tr>`;
        });
      });
    }

    function addDepartment() {
      const department = { name: "Pediatrics", head: "Dr. Neha Verma" };
      db.collection("departments").add(department).then(loadDepartments);
    }

    function loadDepartments() {
      db.collection("departments").get().then(snapshot => {
        const tbody = document.querySelector("#departmentTable tbody");
        tbody.innerHTML = "";
        snapshot.forEach(doc => {
          const d = doc.data();
          tbody.innerHTML += `<tr><td>${d.name}</td><td>${d.head}</td></tr>`;
        });
      });
    }

    function loadAllData() {
      loadPatients();
      loadDoctors();
      loadDepartments();
    }
  </script>
</body>
</html>
